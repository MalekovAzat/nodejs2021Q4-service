# RS School REST service

## Prerequisites

- Git - [Download & Install Git](https://git-scm.com/downloads).
- Node.js - [Download & Install Node.js](https://nodejs.org/en/download/) and the npm package manager.

## Downloading

```
git clone {repository URL}
```

## Installing NPM modules

```
npm install
```

## Running application

```
npm start
```

After starting the app on port (4000 as default) you can open
in your browser OpenAPI documentation by typing http://localhost:4000/doc/.
For more information about OpenAPI/Swagger please visit https://swagger.io/.

## Testing

After application running open new terminal and enter:

To run all tests without authorization

```
npm test
```

To run only one of all test suites (users, boards or tasks)

```
npm test <suite name>
```

To run all test with authorization

```
npm run test:auth
```

To run only specific test suite with authorization (users, boards or tasks)

```
npm run test:auth <suite name>
```

## Development

If you're using VSCode, you can get a better developer experience from integration with [ESLint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint) and [Prettier](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode) extensions.

### Auto-fix and format

```
npm run lint
```

### Debugging in VSCode

Press <kbd>F5</kbd> to debug.

For more information, visit: https://code.visualstudio.com/docs/editor/debugging

## How to start the application in docker container

### Requirements

1. Installed `docker`.
2. Installed `docker-compose`.

The application contains several containers:

1. Backend application.
2. Postgres database.

To start the container use the `docker-compose` command in the root folder of the application:

```bash
docker-compose up
```

This command creates and starts 2 containers with shared network.

There are an opportunity to choose some of the env variables described in `.env` file.

### How to test the application

For testing the docker containers should be turned on.
Execute next line in bash in the `backend-service` folder:

```bash
npm run test:auth
```

### Performance part

The performanse metrics generated by `artillery`.

The metrics for fastify application:

| Metric                                                                  | Value  |
| ----------------------------------------------------------------------- | ------ |
| http.codes.200                                                          | 600    |
| http.codes.201                                                          | 913    |
| http.codes.204                                                          | 600    |
| http.request_rate                                                       | 8/sec  |
| http.requests                                                           | 2113   |
| min                                                                     | 4      |
| max                                                                     | 3844   |
| median                                                                  | 67.4   |
| p95                                                                     | 907    |
| p99                                                                     | 2143.5 |
| http.responses                                                          | 2113   |
| vusers.completed                                                        | 600    |
| vusers.created                                                          | 600    |
| vusers.created_by_name.Add board + Add task + update task + delete Task | 313    |
| vusers.created_by_name.Add user + update user + delete user             | 287    |
| min                                                                     | 83.7   |
| max                                                                     | 6490.5 |
| median                                                                  | 376.2  |
| p95                                                                     | 3134.5 |
| p99                                                                     | 4403.8 |

The metrics for express application:
| Metric | Value |
| ----------------------------------------------------------------------- | ------ |
| http.codes.200| 600 |
| http.codes.201| 908 |
| http.codes.204| 600 |
| http.request_rate| 8/sec |
| http.requests| 2108 |
| min| 5 |
| max| 5478 |
| median| 98.5 |
| p95| 1380.5 |
| p99| 3262.4 |
| http.responses| 2108 |
| vusers.completed| 600 |
| vusers.created| 600 |
| vusers.created_by_name.Add board + Add task + update task + delete Task| 308 |
| vusers.created_by_name.Add user + update user + delete user| 292 |
| min| 86.9 |
| max| 7975.8 |
| median| 487.9 |
| p95| 5065.6 |
| p99| 7117 |
